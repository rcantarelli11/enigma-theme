{%- liquid
  comment
    Renders a text input.

    Required parameters:
      - id: { String } The input's ID.
      - name: { String } The input's name.
      - label: { String } The input's label.

    Optional parameters:
      - input_type: { string: 'text' } The input's type attribute.
      - class: { String } The input's class.
      - placeholder: { String } The input's placeholder. Should always be passed when using the 'internal'
          label type because the label functionality depends on the ':placeholder-shown' psuedo selector, so
          we need the placeholder to exist.
      - default_value: { String } The input's default value.
      - required: { Boolean: false } Whether the input is required.
      - use_required_label: { Boolean: true } Whether to convert the label into the required label.
      - label_type: { String: 'internal' } The label type. Can be:
        - 'internal': Displays inside the input container.
        - 'external': Displays outside the input container.
      - help_text: { String } Text to be shown below the input.
      - has_error: { Boolean: false } Whether there's an error associated with the input.
      - error_message: { String } The message to display when there's an error associated
          with the input.
      - force_render_error_container: { Boolean: false } Always render an error container, even when empty.
      - error_custom_id: { String } ID to add as a means to control error message style or func.
      - attributes: { String } Attributes to apply to the input.
      - form_id: { String } ID of the form to connect the input with.
      - pattern: { String } A regex for specifying the allowable characters in the input.
  endcomment

  assign required = required | default: false, allow_false: true
  assign use_required_label = use_required_label | default: true, allow_false: true
  assign input_type = input_type | default: 'text'
  assign label_type = label_type | default: 'internal'

  capture label_type_class
    echo 'label-[[lt]]' | replace: '[[lt]]', label_type
  endcapture

  if required and use_required_label
    assign label = 'general.forms.required_label' | t: label: label
  endif

  capture label_element
    echo '<label for="[[id]]">[[label]]</label>' | replace: '[[id]]', id | replace: '[[label]]', label
  endcapture
-%}

<div class="custom-input-wrapper">
  <div class="custom-input custom-input--text {{ label_type_class }} {%- if has_error %} has-error{%- endif -%}">
    {%- liquid
      if label_type == 'external'
        echo label_element
      endif
    -%}

    <input
      type="{{ input_type }}"
      id="{{ id }}"
      name="{{ name }}"

      {%- if class != blank %}
        class="{{ class }} ff-body"
      {%- endif -%}

      value="{{ default_value }}"
      placeholder="{{ placeholder }}"

      {%- if form_id != blank -%}
        form="{{ form_id }}"
      {%- endif -%}

      {%- if required %}
        required
      {%- endif -%}

      {%- if attributes != blank %}
        {{ attributes }}
      {%- endif -%}

      {%- if pattern != blank %}
        pattern="{{ pattern }}"
      {%- endif -%}
    >

    {%- liquid
      if label_type == 'internal'
        echo label_element
      endif
    -%}
  </div>

  {%- if force_render_error_container or has_error and error_message != blank -%}
    <div
      class="notification-display error-display"
      {% if error_custom_id != blank %}
        id="{{ error_custom_id }}"
      {%- endif -%}
    >
      {{ error_message }}
    </div>
  {%- endif -%}

  {%- if help_text != blank -%}
    <div class="custom-input-help-text">{{ help_text }}</div>
  {%- endif -%}
</div>
