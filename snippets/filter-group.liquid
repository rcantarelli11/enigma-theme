{%- liquid
  comment
    Renders a filter group (ie. a filter, and it's values).

    Required parameters:
      - filter: { Object } The filter object.
      - swatch_variant_options: { Object } An array of swatch variant options (based on
          'settings.swatch_variant_options').
      - custom_swatch_color_key_map: { Object } An array of custom swatch color keys (names).
      - custom_swatch_color_value_map: { Object } An array of custom swatch color values (HEX values).
      - group_open: { Boolean } Whether the filter group accordion should be expanded.
  endcomment
-%}

{%-
  # Boolean filters, and the standard "Availability" filter, are output as individual items. Others are
  # output as accordions with filters inside.
-%}
{%- if filter.type == 'boolean' or filter.type == 'list' and filter.values.first.param_name contains 'availability' -%}
  <div class="filter-group-wrapper" js-filter-group-parent>
    <ul id="{{ filter.param_name }}" class="filter-group filter-group--single-value" js-filter-group>
      {%- liquid
        # Normally, the standard "Availability" filter would be shown as a multi select with options "In stock" and
        # "Out of stock". However, we want it to appear as a switch of "In stock only".
        if filter.type == 'list' and filter.values.first.param_name contains 'availability'
          for value in filter.values
            if value.value == '1'
              capture filter_label
                echo 'shared.filtering_and_sorting.in_stock_only' | t
              endcapture

              render 'filter-item', type: 'switch', filter: filter, value: value, label: filter_label

              break
            endif
          endfor
        elsif filter.type == 'boolean'
          assign filter_value = filter.true_value

          capture filter_label
            echo filter.label
          endcapture

          render 'filter-item', type: 'switch', filter: filter, value: filter_value, label: filter_label
        endif
      -%}
    </ul>
  </div>
{%- else -%}
  {%- liquid
    capture filter_content
      if filter.type == 'list'
        render 'list-filter', filter: filter, swatch_variant_options: swatch_variant_options, custom_swatch_color_key_map: custom_swatch_color_key_map, custom_swatch_color_value_map: custom_swatch_color_value_map
      else
        render 'price-range-filter', filter: filter
      endif
    endcapture

    # If a collection only has free products, don't show price filters
    unless filter.range_max == 0
      capture accordion_content
        render 'accordion-item', title: filter.label, content: filter_content, class: 'filter-group-wrapper', open: group_open
      endcapture

      render 'accordion', items: accordion_content, attributes: 'js-filter-group-parent'
    endunless
  -%}
{%- endif -%}
