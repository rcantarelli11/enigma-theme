{%- liquid
  comment
    Saves all global color and typography settings, along with other related values, to CSS
    variables on the :root to be used throughout the theme.
  endcomment

  # Heading fonts
  assign heading_font = settings.heading_font
  assign heading_font_bold = heading_font | font_modify: 'weight', '+300'

  # Body fonts
  assign body_font = settings.body_font
  assign body_font_bold = body_font | font_modify: 'weight', '+300'
  assign body_font_italic = body_font | font_modify: 'style', 'italic'
  assign body_font_bold_italic = body_font_bold | font_modify: 'style', 'italic'
-%}

<style>
  {%- # Font face declarations -%}
  {{ heading_font | font_face: font_display: 'swap' }}
  {{ heading_font_bold | font_face: font_display: 'swap' }}
  {{ body_font | font_face: font_display: 'swap' }}
  {{ body_font_bold | font_face: font_display: 'swap' }}
  {{ body_font_italic | font_face: font_display: 'swap' }}
  {{ body_font_bold_italic | font_face: font_display: 'swap' }}

  :root {
    {%- liquid
      # ---------------------------------------
      #  Colors
      # ---------------------------------------

      # Color schemes
      render 'color-scheme-to-vars', color_scheme: settings.default_color_scheme
      render 'color-scheme-to-vars', color_scheme: settings.popover_modal_color_scheme, prefix: 'popup-modal'
      render 'color-scheme-to-vars', color_scheme: settings.drawer_color_scheme, prefix: 'drawer'

      # General color settings
      render 'color-global-category-to-vars.liquid', category: 'products', setting_ids: 'sale, sold_out, low_inventory, in_stock'
      render 'color-global-category-to-vars.liquid', category: 'notifications', setting_ids: 'success, error'

      echo '--color-white: #ffffff;'
      echo '--color-black: #000000;'

      # ---------------------------------------
      #  Typography
      # ---------------------------------------

      # Heading variation variables
      assign heading_levels = 'display-1, display-2, display-3, 1-base, 2-base, 3-base, 4-base, 5-base, 6-base'
      assign heading_multipliers = '1.5, 1.333, 1.1666, 1, 0.875, 0.75, 0.65, 0.6, 0.55'

      # Body variation variables
      assign body_levels = '400, 350, 300, 250, 200, 150, 100, 75, 60, 50, 25, 20'
      assign body_multipliers = '1.666, 1.555, 1.444, 1.333, 1.222, 1.111, 1, 0.888, 0.8222, 0.777, 0.722, 0.666'

      # Navigation variables and logic
      assign navigation_levels = 'regular'
      assign navigation_multipliers = '1'

      if settings.navigation_font == 'heading'
        assign navigation_font = heading_font
      else
        assign navigation_font = body_font
      endif

      # Button variation variables and logic
      assign button_levels = 'regular, small'

      if settings.button_font == 'heading'
        assign button_font = heading_font
      else
        assign button_font = body_font
      endif

      if settings.button_casing == "normal"
        # body-100, body-75
        assign button_multipliers = '1, 0.888'
      else
        # (body-100 * 0.9), (body-75 * 0.93)
        assign button_multipliers = '0.9, 0.8258'
      endif
    -%}

    {%- # Headings -%}
    {%- render 'font-type-to-vars',
      type: 'heading',
      casing: settings.heading_casing,
      letter_spacing: settings.heading_letter_spacing,
      font: heading_font,
      bold_font: heading_font_bold,
      desktop_size: settings.heading_font_size_desktop,
      mobile_scale: settings.heading_mobile_font_size_scale,
      levels: heading_levels,
      multipliers: heading_multipliers
    -%}

    {%- # Body -%}
    {%- render 'font-type-to-vars',
      type: 'body',
      letter_spacing: settings.body_letter_spacing,
      font: body_font,
      bold_font: body_font_bold,
      desktop_size: settings.body_font_size_desktop,
      mobile_scale: settings.body_mobile_font_size_scale,
      levels: body_levels,
      multipliers: body_multipliers
    -%}

    {%- # Navigation -%}
    {%- render 'font-type-to-vars',
      type: 'navigation',
      casing: settings.navigation_casing,
      letter_spacing: settings.navigation_letter_spacing,
      font: navigation_font,
      desktop_size: settings.navigation_font_size_desktop,
      levels: navigation_levels,
      mobile_scale: 100,
      multipliers: navigation_multipliers,
      font_source: settings.navigation_font
    -%}

    {%- # Buttons -%}
    {%- render 'font-type-to-vars',
      type: 'button',
      casing: settings.button_casing,
      letter_spacing: settings.button_letter_spacing,
      font: button_font,
      desktop_size: settings.body_font_size_desktop,
      mobile_scale: settings.body_mobile_font_size_scale,
      levels: button_levels,
      multipliers: button_multipliers
    -%}

    {%- # Corner rounding -%}
    --radius-drawer: {{ settings.corner_rounding_drawers_and_modals }}px;
    --radius-modal: {{ settings.corner_rounding_drawers_and_modals }}px;
    --radius-popover: {{ settings.corner_rounding_popover }}px;
    --radius-card: {{ settings.corner_rounding_card }}px;
    --radius-image: {{ settings.corner_rounding_image }}px;
    --radius-image-thumbnail: {{ settings.corner_rounding_image_thumbnail }}px;
    --radius-button: {{ settings.corner_rounding_button }}px;
    --radius-input: {{ settings.corner_rounding_input }}px;
    --radius-badge: {{ settings.corner_rounding_badge }}px;
    --radius-button-within-popover: {{ settings.corner_rounding_popover | times: 0.7 }}px;
    --radius-button-within-drawer: {{ settings.corner_rounding_drawers_and_modals | times: 0.5 }}px;
  }
</style>
